name: Build MicroG and Aurora APKs

on:
  workflow_dispatch:

jobs:
  build-gmscore:
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout GmsCore fork
        uses: actions/checkout@v4
        with:
          repository: Jesusdio2/GmsCore

      - name: Set up JDK 11
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: 11

      - name: Make gradlew executable
        run: chmod +x gradlew

      - name: Build GmsCore
        run: ./gradlew assembleRelease

      - name: Upload GmsCore APK
        uses: actions/upload-artifact@v4
        with:
          name: GmsCore
          path: app/build/outputs/apk/release/*.apk

  build-gsfproxy:
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout GsfProxy fork
        uses: actions/checkout@v4
        with:
          repository: Jesusdio2/ServicesFrameworkProxy

      - name: Set up JDK 11
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: 11

      - name: Make gradlew executable
        run: chmod +x gradlew

      - name: Build GsfProxy
        run: ./gradlew assembleRelease

      - name: Upload GsfProxy APK
        uses: actions/upload-artifact@v4
        with:
          name: GsfProxy
          path: app/build/outputs/apk/release/*.apk

  build-aurora:
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout AuroraStore fork
        uses: actions/checkout@v4
        with:
          repository: Jesusdio2/AuroraStore

      - name: Set up JDK 11
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: 11

      - name: Make gradlew executable
        run: chmod +x gradlew

      - name: Build AuroraStore
        run: ./gradlew assembleRelease

      - name: Upload AuroraStore APK
        uses: actions/upload-artifact@v4
        with:
          name: AuroraStore
          path: app/build/outputs/apk/release/*.apk
